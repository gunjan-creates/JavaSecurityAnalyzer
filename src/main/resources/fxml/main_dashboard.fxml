<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.securityanalyzer.controller.MainController">

    <!-- Header Section -->
    <top>
        <VBox styleClass="header">
            <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header-bar">
                <Label text="Java Security Analyzer" styleClass="app-title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <MenuBar styleClass="menu-bar">
                    <Menu text="File">
                        <MenuItem text="New Analysis" onAction="#handleNewAnalysis"/>
                        <MenuItem text="Open Results" onAction="#handleOpenResults"/>
                        <MenuItem text="Save Results" onAction="#handleSaveResults"/>
                        <SeparatorMenuItem/>
                        <MenuItem text="Exit" onAction="#handleExit"/>
                    </Menu>
                    <Menu text="Tools">
                        <MenuItem text="Export Report" onAction="#handleExportReport"/>
                        <MenuItem text="Settings" onAction="#handleSettings"/>
                    </Menu>
                    <Menu text="Help">
                        <MenuItem text="About" onAction="#handleAbout"/>
                    </Menu>
                </MenuBar>
            </HBox>
        </VBox>
    </top>

    <!-- Main Content Area -->
    <center>
        <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE" styleClass="main-tab-pane">

            <!-- Security Dashboard Tab -->
            <Tab text="Security Dashboard" styleClass="dashboard-tab">
                <VBox spacing="15" styleClass="tab-content">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <!-- Overall Security Score Section -->
                    <HBox alignment="CENTER" spacing="30" styleClass="score-section">
                        <VBox alignment="CENTER" styleClass="overall-score-container">
                            <Label text="Overall Security Score" styleClass="score-title"/>
                            <Label fx:id="overallScoreLabel" text="85/100" styleClass="overall-score"/>
                            <Label fx:id="riskLevelLabel" text="LOW RISK" styleClass="risk-level"/>
                        </VBox>

                        <VBox spacing="10" styleClass="category-scores">
                            <Label text="Category Breakdown" styleClass="section-title"/>
                            <HBox spacing="15">
                                <VBox alignment="CENTER" styleClass="category-score-card">
                                    <Label text="Password" styleClass="category-name"/>
                                    <Label fx:id="passwordScoreLabel" text="90/100" styleClass="category-score"/>
                                    <ProgressBar fx:id="passwordScoreBar" progress="0.9" styleClass="password-progress"/>
                                </VBox>
                                <VBox alignment="CENTER" styleClass="category-score-card">
                                    <Label text="Network" styleClass="category-name"/>
                                    <Label fx:id="networkScoreLabel" text="75/100" styleClass="category-score"/>
                                    <ProgressBar fx:id="networkScoreBar" progress="0.75" styleClass="network-progress"/>
                                </VBox>
                                <VBox alignment="CENTER" styleClass="category-score-card">
                                    <Label text="Encryption" styleClass="category-name"/>
                                    <Label fx:id="encryptionScoreLabel" text="80/100" styleClass="category-score"/>
                                    <ProgressBar fx:id="encryptionScoreBar" progress="0.8" styleClass="encryption-progress"/>
                                </VBox>
                                <VBox alignment="CENTER" styleClass="category-score-card">
                                    <Label text="System" styleClass="category-name"/>
                                    <Label fx:id="systemScoreLabel" text="85/100" styleClass="category-score"/>
                                    <ProgressBar fx:id="systemScoreBar" progress="0.85" styleClass="system-progress"/>
                                </VBox>
                            </HBox>
                        </VBox>
                    </HBox>

                    <!-- Recommendations Section -->
                    <VBox spacing="10" styleClass="recommendations-section">
                        <Label text="Security Recommendations" styleClass="section-title"/>
                        <ScrollPane fitToWidth="true" prefHeight="200" styleClass="recommendations-scroll">
                            <VBox fx:id="recommendationsContainer" spacing="5"/>
                        </ScrollPane>
                    </VBox>

                    <!-- Quick Actions -->
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <Label text="Quick Actions:" styleClass="section-title"/>
                        <Button text="Run Full Scan" onAction="#handleRunFullScan" styleClass="action-button primary"/>
                        <Button text="Update Scores" onAction="#handleUpdateScores" styleClass="action-button secondary"/>
                        <Button text="Export Report" onAction="#handleExportReport" styleClass="action-button secondary"/>
                    </HBox>
                </VBox>
            </Tab>

            <!-- Password Analysis Tab -->
            <Tab text="Password Analysis" styleClass="password-tab">
                <VBox spacing="15" styleClass="tab-content">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <Label text="Password Strength Analysis" styleClass="tab-title"/>

                    <!-- Password Input Section -->
                    <GridPane hgap="15" vgap="10" styleClass="input-section">
                        <Label text="Enter Password:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="input-label"/>
                        <PasswordField fx:id="passwordField" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                       styleClass="password-input" prefWidth="300"/>
                        <CheckBox fx:id="showPasswordCheckBox" text="Show Password"
                                  GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                        <TextField fx:id="visiblePasswordField" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                   visible="false" managed="false" styleClass="password-input" prefWidth="300"/>

                        <Button text="Analyze Password" onAction="#handleAnalyzePassword"
                               GridPane.columnIndex="1" GridPane.rowIndex="1" styleClass="analyze-button"/>
                    </GridPane>

                    <!-- Strength Indicator -->
                    <VBox spacing="5" styleClass="strength-section">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Password Strength:" styleClass="strength-label"/>
                            <Label fx:id="strengthScoreLabel" text="--/100" styleClass="strength-value"/>
                            <Label fx:id="strengthCategoryLabel" text="--" styleClass="strength-category"/>
                        </HBox>
                        <ProgressBar fx:id="strengthProgressBar" progress="0" styleClass="strength-progress"/>
                    </VBox>

                    <!-- Analysis Results -->
                    <SplitPane dividerPositions="0.5" styleClass="results-split">
                        <!-- Left Panel: Pattern Analysis -->
                        <VBox spacing="10">
                            <Label text="Pattern Analysis" styleClass="results-title"/>
                            <ScrollPane fitToWidth="true" prefHeight="200">
                                <VBox fx:id="patternAnalysisContainer" spacing="5"/>
                            </ScrollPane>
                        </VBox>

                        <!-- Right Panel: Suggestions -->
                        <VBox spacing="10">
                            <Label text="Improvement Suggestions" styleClass="results-title"/>
                            <ScrollPane fitToWidth="true" prefHeight="200">
                                <VBox fx:id="suggestionsContainer" spacing="5"/>
                            </ScrollPane>
                        </VBox>
                    </SplitPane>
                </VBox>
            </Tab>

            <!-- Port Scanner Tab -->
            <Tab text="Port Scanner" styleClass="scanner-tab">
                <VBox spacing="15" styleClass="tab-content">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <Label text="Network Port Scanner" styleClass="tab-title"/>

                    <!-- Scan Configuration -->
                    <GridPane hgap="15" vgap="10" styleClass="scan-config">
                        <Label text="Target Host:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="input-label"/>
                        <TextField fx:id="targetHostField" text="localhost"
                                  GridPane.columnIndex="1" GridPane.rowIndex="0" styleClass="host-input"/>

                        <Label text="Port Range:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="input-label"/>
                        <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <TextField fx:id="startPortField" text="1" prefWidth="80" styleClass="port-input"/>
                            <Label text="to"/>
                            <TextField fx:id="endPortField" text="1024" prefWidth="80" styleClass="port-input"/>
                            <Button text="Common Ports" onAction="#handleSetCommonPorts" styleClass="preset-button"/>
                            <Button text="All Ports" onAction="#handleSetAllPorts" styleClass="preset-button"/>
                        </HBox>

                        <Label text="Timeout (ms):" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="input-label"/>
                        <TextField fx:id="timeoutField" text="1000" prefWidth="100"
                                  GridPane.columnIndex="1" GridPane.rowIndex="2" styleClass="timeout-input"/>

                        <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="3">
                            <Button fx:id="startScanButton" text="Start Scan" onAction="#handleStartScan"
                                   styleClass="scan-button primary"/>
                            <Button fx:id="stopScanButton" text="Stop Scan" onAction="#handleStopScan"
                                   disable="true" styleClass="scan-button danger"/>
                            <Button text="Clear Results" onAction="#handleClearScanResults" styleClass="scan-button secondary"/>
                        </HBox>
                    </GridPane>

                    <!-- Scan Progress -->
                    <VBox spacing="5" styleClass="scan-progress" fx:id="progressSection" visible="false" managed="false">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Scan Progress:" styleClass="progress-label"/>
                            <Label fx:id="scanProgressLabel" text="0/0 ports (0%)" styleClass="progress-value"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="scanTimeLabel" text="00:00" styleClass="time-label"/>
                        </HBox>
                        <ProgressBar fx:id="scanProgressBar" progress="0" styleClass="scan-progress-bar"/>
                    </VBox>

                    <!-- Scan Results -->
                    <VBox spacing="10" styleClass="scan-results">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="Scan Results" styleClass="results-title"/>
                            <Label fx:id="scanStatsLabel" text="No scan performed" styleClass="scan-stats"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <CheckBox fx:id="showVulnerableOnly" text="Show Vulnerable Only"/>
                        </HBox>

                        <TableView fx:id="scanResultsTable" styleClass="results-table">
                            <columns>
                                <TableColumn fx:id="portColumn" text="Port" prefWidth="60"/>
                                <TableColumn fx:id="statusColumn" text="Status" prefWidth="80"/>
                                <TableColumn fx:id="serviceColumn" text="Service" prefWidth="120"/>
                                <TableColumn fx:id="responseTimeColumn" text="Response Time" prefWidth="100"/>
                                <TableColumn fx:id="vulnerabilitiesColumn" text="Vulnerabilities" prefWidth="200"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <!-- File Encryption Tab -->
            <Tab text="File Encryption" styleClass="encryption-tab">
                <VBox spacing="15" styleClass="tab-content">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <Label text="File Encryption &amp; Decryption" styleClass="tab-title"/>

                    <!-- File Selection -->
                    <GridPane hgap="15" vgap="10" styleClass="file-selection">
                        <Label text="Select File:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="input-label"/>
                        <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <TextField fx:id="selectedFilePath" editable="false" styleClass="file-path" prefWidth="400"/>
                            <Button text="Browse" onAction="#handleBrowseFile" styleClass="browse-button"/>
                        </HBox>

                        <Label text="Algorithm:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="input-label"/>
                        <ComboBox fx:id="algorithmComboBox" GridPane.columnIndex="1" GridPane.rowIndex="1" styleClass="algorithm-combo"/>

                        <Label text="Password:" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="input-label"/>
                        <PasswordField fx:id="encryptionPasswordField" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                      styleClass="password-input" prefWidth="300"/>

                        <HBox spacing="15" GridPane.columnIndex="1" GridPane.rowIndex="3">
                            <Button text="Encrypt" onAction="#handleEncryptFile" styleClass="encrypt-button primary"/>
                            <Button text="Decrypt" onAction="#handleDecryptFile" styleClass="decrypt-button primary"/>
                            <Button text="Generate RSA Keys" onAction="#handleGenerateKeys" styleClass="key-button secondary"/>
                        </HBox>
                    </GridPane>

                    <!-- Encryption Progress -->
                    <VBox spacing="5" styleClass="encryption-progress" fx:id="encryptionProgressSection"
                         visible="false" managed="false">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Progress:" styleClass="progress-label"/>
                            <Label fx:id="encryptionProgressLabel" text="0%" styleClass="progress-value"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="encryptionTimeLabel" text="00:00" styleClass="time-label"/>
                        </HBox>
                        <ProgressBar fx:id="encryptionProgressBar" progress="0" styleClass="encryption-progress-bar"/>
                    </VBox>

                    <!-- Encryption History -->
                    <VBox spacing="10" styleClass="encryption-history">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="Encryption History" styleClass="results-title"/>
                            <Button text="Clear History" onAction="#handleClearEncryptionHistory" styleClass="clear-button"/>
                        </HBox>

                        <TableView fx:id="encryptionHistoryTable" styleClass="history-table">
                            <columns>
                                <TableColumn fx:id="timestampColumn" text="Time" prefWidth="120"/>
                                <TableColumn fx:id="operationColumn" text="Operation" prefWidth="100"/>
                                <TableColumn fx:id="algorithmColumn" text="Algorithm" prefWidth="100"/>
                                <TableColumn fx:id="fileNameColumn" text="File Name" prefWidth="200"/>
                                <TableColumn fx:id="fileSizeColumn" text="Size" prefWidth="80"/>
                                <TableColumn fx:id="statusColumn" text="Status" prefWidth="80"/>
                                <TableColumn fx:id="verificationColumn" text="Verified" prefWidth="80"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

        </TabPane>
    </center>

    <!-- Status Bar -->
    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="15" styleClass="status-bar">
            <padding>
                <Insets top="5" right="10" bottom="5" left="10"/>
            </padding>
            <Label fx:id="statusLabel" text="Ready" styleClass="status-text"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="connectionStatusLabel" text="Offline" styleClass="connection-status"/>
            <Separator orientation="VERTICAL"/>
            <Label fx:id="timestampLabel" text="" styleClass="timestamp"/>
        </HBox>
    </bottom>

</BorderPane>